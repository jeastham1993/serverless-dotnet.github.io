<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-developer-tooling/terraform">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Terraform | Serverless .NET</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://serverlessdotnet.dev/docs/developer-tooling/terraform"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content=".NET, serverless, aws, aws lambda, dotnet"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Terraform | Serverless .NET"><meta data-rh="true" name="description" content="Terraform is one of the most popular infrastructure as code (IaC) tools available today. It enables the automation of infrastructure across any cloud. Terraform allows you to build any kind of infrastructure, not just serverless. For this example, let&#x27;s focus on deploying a Lambda function."><meta data-rh="true" property="og:description" content="Terraform is one of the most popular infrastructure as code (IaC) tools available today. It enables the automation of infrastructure across any cloud. Terraform allows you to build any kind of infrastructure, not just serverless. For this example, let&#x27;s focus on deploying a Lambda function."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://serverlessdotnet.dev/docs/developer-tooling/terraform"><link data-rh="true" rel="alternate" href="https://serverlessdotnet.dev/docs/developer-tooling/terraform" hreflang="en"><link data-rh="true" rel="alternate" href="https://serverlessdotnet.dev/docs/developer-tooling/terraform" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ELBLZN8LN3"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-ELBLZN8LN3",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.e00d95ac.css">
<link rel="preload" href="/assets/js/runtime~main.983b73cc.js" as="script">
<link rel="preload" href="/assets/js/main.761a135f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Serverless .NET</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jeastham1993/serverless-dotnet.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/fundamentals">Fundamentals</a><button aria-label="Toggle the collapsible sidebar category &#x27;Fundamentals&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/your-first-lambda">Your First Lambda</a><button aria-label="Toggle the collapsible sidebar category &#x27;Your First Lambda&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/aspnet-on-lambda">ASP.NET on Lambda</a><button aria-label="Toggle the collapsible sidebar category &#x27;ASP.NET on Lambda&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/event-sources">Event Sources</a><button aria-label="Toggle the collapsible sidebar category &#x27;Event Sources&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/developer-tooling">Developer Tooling</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer Tooling&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer-tooling/aws-sam">AWS SAM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer-tooling/cdk">AWS CDK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/developer-tooling/terraform">Terraform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer-tooling/pulumi">Pulumi</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/testing">Testing</a><button aria-label="Toggle the collapsible sidebar category &#x27;Testing&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/ide-support">IDE Support</a><button aria-label="Toggle the collapsible sidebar category &#x27;IDE Support&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/observability">Observability</a><button aria-label="Toggle the collapsible sidebar category &#x27;Observability&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/build-patterns">Build Patterns</a><button aria-label="Toggle the collapsible sidebar category &#x27;Build Patterns&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/advanced-concepts">Advanced Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/developer-tooling"><span itemprop="name">Developer Tooling</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Terraform</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Terraform</h1></header><p><a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">Terraform</a> is one of the most popular infrastructure as code (IaC) tools available today. It enables the automation of infrastructure across any cloud. Terraform allows you to build any kind of infrastructure, not just serverless. For this example, let&#x27;s focus on deploying a Lambda function.</p>
<p>Deploying .NET Lambda functions using Terraform adds an additional complexity. Your .NET function code needs to be compiled before Terraform can deploy your resources. This is less of an issue for interpreted languages like NodeJS and Python as no compilation is required.</p>
<p>However, the first thing you&#x27;ll need to do is <a href="https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli" target="_blank" rel="noopener noreferrer">install Terraform.</a>.</p>
<p>Once installed, create a new directory:</p>
<div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="start-terraform" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>start-terraform</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>mkdir terraform-dotnet-serverless</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>cd terraform-dotnet-serverless</span></div></div><br></code></div></div></div></div>
<p>Then create a file called <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span style="color:#D8DEE9">main</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">tf</span></code></span>.</p>
<p>Copy in the below code. There&#x27;s a lot, don&#x27;t worry I&#x27;ll walk through it step by step:</p>
<details><summary>Click Here for Code Sample</summary><div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.tf" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>main.tf</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>terraform {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  required_providers {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    aws = {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      source  = &quot;hashicorp/aws&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      version = &quot;~&gt; 4.0&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;random_uuid&quot; &quot;bucket_random_id&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span># Configure the AWS Provider</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>provider &quot;aws&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  region = &quot;eu-west-1&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span># Create S3 bucket to store our application source code.</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_s3_bucket&quot; &quot;lambda_bucket&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  bucket        = &quot;${random_uuid.bucket_random_id.result}-dotnet-tf-bucket&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  acl           = &quot;private&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  force_destroy = true</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>data &quot;archive_file&quot; &quot;lambda_archive&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  type = &quot;zip&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  source_dir  = &quot;Functions/Dotnet.CDK.Lambda/src/Dotnet.CDK.Lambda/bin/Release/net6.0/linux-x64/publish&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  output_path = &quot;Dotnet.CDK.Lambda.zip&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_s3_object&quot; &quot;lambda_bundle&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  bucket = aws_s3_bucket.lambda_bucket.id</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  key    = &quot;Dotnet.CDK.Lambda.zip&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  source = data.archive_file.lambda_archive.output_path</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  etag = filemd5(data.archive_file.lambda_archive.output_path)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_cloudwatch_log_group&quot; &quot;aggregator&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  name = &quot;/aws/lambda/${aws_lambda_function.function.function_name}&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  retention_in_days = 30</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_iam_role&quot; &quot;lambda_function_role&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  name = &quot;FunctionIamRole_dotnet-terraform-lambda&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  assume_role_policy = jsonencode({</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Version = &quot;2012-10-17&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Statement = [{</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      Action = &quot;sts:AssumeRole&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      Effect = &quot;Allow&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      Sid    = &quot;&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      Principal = {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        Service = &quot;lambda.amazonaws.com&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    ]</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  })</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_iam_role_policy_attachment&quot; &quot;lambda_policy_attach&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  role       = aws_iam_role.lambda_function_role.name</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  policy_arn = &quot;arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_lambda_function&quot; &quot;function&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  function_name    = &quot;dotnet-terraform-lambda&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  s3_bucket        = aws_s3_bucket.lambda_bucket.id</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  s3_key           = aws_s3_object.lambda_bundle.key</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  runtime          = &quot;dotnet6&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  handler          = &quot;Dotnet.CDK.Lambda::Dotnet.CDK.Lambda.Function::FunctionHandler&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  source_code_hash = data.archive_file.lambda_archive.output_base64sha256</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  role             = aws_iam_role.lambda_function_role.arn</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  timeout          = 30</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>output &quot;function_name&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  value = aws_lambda_function.function.function_name</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div></details>
<p>Let&#x27;s also create a new Lambda function to use as an example.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>mkdir Functions</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>cd Functions</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>dotnet new lambda.EmptyFunction -n Dotnet.CDK.Lambda</span></div></div><br></code></div></div>
<style class="ssmq-6">.ssmq-6.ssmq-default{display:block}.ssmq-6:not(.ssmq-default){display: none;}
@media not screen, (max-width: 768px){.ssmq-6.ssmq-notscreenmax-width768px{display:block}.ssmq-6:not(.ssmq-notscreenmax-width768px){display: none;}}</style><div class="ssmq-6 ssmq-notscreenmax-width768px"><section class="ch-scrollycoding-static"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="terraform-provider">Terraform Provider<a class="hash-link" href="#terraform-provider" title="Direct link to heading">​</a></h2><p>The opening section of the file configures the AWS provider for Terraform. More documentation on this is found in the <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs" target="_blank" rel="noopener noreferrer">Terraform documentation</a>.</p><div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.tf" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>main.tf</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>terraform {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  required_providers {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    aws = {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      source  = &quot;hashicorp/aws&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      version = &quot;~&gt; 4.0&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span># Configure the AWS Provider</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>provider &quot;aws&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  region = &quot;eu-west-1&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><br></code></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="s3-bucket-for-code-storage">S3 Bucket for Code Storage<a class="hash-link" href="#s3-bucket-for-code-storage" title="Direct link to heading">​</a></h2><p>When packaging Lambda applications as ZIP files an S3 bucket is required to store the code. This code creates a new S3 bucket using a random identifier. You can update the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>bucket</span></code></span> property if you wish to use a different bucket name.</p><div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.tf" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>main.tf</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;random_uuid&quot; &quot;bucket_random_id&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span># Create S3 bucket to store our application source code.</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_s3_bucket&quot; &quot;lambda_bucket&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  bucket        = &quot;${random_uuid.bucket_random_id.result}-dotnet-tf-bucket&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  acl           = &quot;private&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  force_destroy = true</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><br></code></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lambda-zip-package">Lambda ZIP Package<a class="hash-link" href="#lambda-zip-package" title="Direct link to heading">​</a></h2><p>Terraform <a href="https://registry.terraform.io/providers/hashicorp/archive/latest/docs/data-sources/archive_file" target="_blank" rel="noopener noreferrer">provides a data source</a> for generating ZIP files. The publish directory of the Lambda function is specified as the source directory and a ZIP file is generated. This ZIP file is then uploaded to S3 using the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>aws_s3_object</span></code></span> resource.</p><div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.tf" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>main.tf</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>data &quot;archive_file&quot; &quot;lambda_archive&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  type = &quot;zip&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  source_dir  = &quot;Functions/Dotnet.CDK.Lambda/src/Dotnet.CDK.Lambda/bin/Release/net6.0/linux-x64/publish&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  output_path = &quot;Dotnet.CDK.Lambda.zip&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_s3_object&quot; &quot;lambda_bundle&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  bucket = aws_s3_bucket.lambda_bucket.id</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  key    = &quot;Dotnet.CDK.Lambda.zip&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  source = data.archive_file.lambda_archive.output_path</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  etag = filemd5(data.archive_file.lambda_archive.output_path)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><br></code></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cloudwatch">CloudWatch<a class="hash-link" href="#cloudwatch" title="Direct link to heading">​</a></h2><p>Additionally, a Amazon CloudWatch log group is defined to store logs generated by the Lambda function.</p><div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.tf" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>main.tf</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_cloudwatch_log_group&quot; &quot;aggregator&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  name = &quot;/aws/lambda/${aws_lambda_function.function.function_name}&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  retention_in_days = 30</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><br></code></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="iam">IAM<a class="hash-link" href="#iam" title="Direct link to heading">​</a></h2><p>An IAM role and policy allow Lambda execution is then created to provide Lambda with the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>AWSLambdaBasicExecutionRole</span></code></span> required to run.</p><div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.tf" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>main.tf</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_iam_role&quot; &quot;lambda_function_role&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  name = &quot;FunctionIamRole_dotnet-terraform-lambda&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  assume_role_policy = jsonencode({</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Version = &quot;2012-10-17&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Statement = [{</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      Action = &quot;sts:AssumeRole&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      Effect = &quot;Allow&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      Sid    = &quot;&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      Principal = {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        Service = &quot;lambda.amazonaws.com&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    ]</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  })</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_iam_role_policy_attachment&quot; &quot;lambda_policy_attach&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  role       = aws_iam_role.lambda_function_role.name</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  policy_arn = &quot;arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><br></code></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lambda-function-resource">Lambda Function Resource<a class="hash-link" href="#lambda-function-resource" title="Direct link to heading">​</a></h2><p>A Lambda function is defined using the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>aws_lambda_function</span></code></span> resource. Notice that the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>s3_bucket</span></code></span>, <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>s3_key</span></code></span> and <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>source_code_hash</span></code></span> properties are using values from the S3 and asset objects defined earlier.</p><div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.tf" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>main.tf</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>resource &quot;aws_lambda_function&quot; &quot;function&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  function_name    = &quot;dotnet-terraform-lambda&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  s3_bucket        = aws_s3_bucket.lambda_bucket.id</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  s3_key           = aws_s3_object.lambda_bundle.key</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  runtime          = &quot;dotnet6&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  handler          = &quot;Dotnet.CDK.Lambda::Dotnet.CDK.Lambda.Function::FunctionHandler&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  source_code_hash = data.archive_file.lambda_archive.output_base64sha256</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  role             = aws_iam_role.lambda_function_role.arn</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  timeout          = 30</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><br></code></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="output-name">Output Name<a class="hash-link" href="#output-name" title="Direct link to heading">​</a></h2><p>And finally the name of the Lambda function is output to the console.</p><div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.tf" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>main.tf</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>output &quot;function_name&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  value = aws_lambda_function.function.function_name</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><br></code></div></div></div></div></section></div><div class="ssmq-6 ssmq-default"><section class="ch-scrollycoding"><div class="ch-scrollycoding-content"><div class="ch-scrollycoding-step-content" data-selected="true"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="terraform-provider">Terraform Provider<a class="hash-link" href="#terraform-provider" title="Direct link to heading">​</a></h2><p>The opening section of the file configures the AWS provider for Terraform. More documentation on this is found in the <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs" target="_blank" rel="noopener noreferrer">Terraform documentation</a>.</p></div><div class="ch-scrollycoding-step-content"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="s3-bucket-for-code-storage">S3 Bucket for Code Storage<a class="hash-link" href="#s3-bucket-for-code-storage" title="Direct link to heading">​</a></h2><p>When packaging Lambda applications as ZIP files an S3 bucket is required to store the code. This code creates a new S3 bucket using a random identifier. You can update the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>bucket</span></code></span> property if you wish to use a different bucket name.</p></div><div class="ch-scrollycoding-step-content"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lambda-zip-package">Lambda ZIP Package<a class="hash-link" href="#lambda-zip-package" title="Direct link to heading">​</a></h2><p>Terraform <a href="https://registry.terraform.io/providers/hashicorp/archive/latest/docs/data-sources/archive_file" target="_blank" rel="noopener noreferrer">provides a data source</a> for generating ZIP files. The publish directory of the Lambda function is specified as the source directory and a ZIP file is generated. This ZIP file is then uploaded to S3 using the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>aws_s3_object</span></code></span> resource.</p></div><div class="ch-scrollycoding-step-content"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cloudwatch">CloudWatch<a class="hash-link" href="#cloudwatch" title="Direct link to heading">​</a></h2><p>Additionally, a Amazon CloudWatch log group is defined to store logs generated by the Lambda function.</p></div><div class="ch-scrollycoding-step-content"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="iam">IAM<a class="hash-link" href="#iam" title="Direct link to heading">​</a></h2><p>An IAM role and policy allow Lambda execution is then created to provide Lambda with the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>AWSLambdaBasicExecutionRole</span></code></span> required to run.</p></div><div class="ch-scrollycoding-step-content"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lambda-function-resource">Lambda Function Resource<a class="hash-link" href="#lambda-function-resource" title="Direct link to heading">​</a></h2><p>A Lambda function is defined using the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>aws_lambda_function</span></code></span> resource. Notice that the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>s3_bucket</span></code></span>, <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>s3_key</span></code></span> and <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span>source_code_hash</span></code></span> properties are using values from the S3 and asset objects defined earlier.</p></div><div class="ch-scrollycoding-step-content"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="output-name">Output Name<a class="hash-link" href="#output-name" title="Direct link to heading">​</a></h2><p>And finally the name of the Lambda function is output to the console.</p></div></div><div class="ch-scrollycoding-sticker"><div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.tf" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>main.tf</div></div><div style="flex:1;min-width:0.8em"></div><svg class="ch-editor-button" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="button"><title>Expand</title><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path></svg><dialog class="ch-expand-dialog"><svg class="ch-expand-close" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="button"><title>Close</title><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></dialog></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>terraform {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  required_providers {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    aws = {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      source  = &quot;hashicorp/aws&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>      version = &quot;~&gt; 4.0&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span># Configure the AWS Provider</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>provider &quot;aws&quot; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>  region = &quot;eu-west-1&quot;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#...</span></div></div><br></code></div></div></div></div></div></section></div><script class="ssmq-6">!function(){for(var e=["not screen, (max-width: 768px)","default"],t=["ssmq-notscreenmax-width768px","ssmq-default"],s=document.getElementsByTagName("script"),o=s[s.length-1].parentNode,r=null,c=0;c<e.length-1;c++)if(window.matchMedia(e[c]).matches){r=o.querySelector(":scope > .ssmq-6."+t[c]);break}if(!r){var a=t.pop();r=o.querySelector(":scope > .ssmq-6."+a)}r.removeAttribute("class"),o.querySelectorAll(":scope > .ssmq-6").forEach((function(e){o.removeChild(e)}))}()</script>
<p>Once defined, run the below commands from a terminal window in the same folder as the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span style="color:#D8DEE9">main</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">tf</span></code></span> file.</p>
<div class="ch-codegroup not-prose"><div class="ch-editor-frame" style="background:#2e3440"><div class="ch-frame-title-bar" style="color:#C5C5C5;background:#2e3440"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="deploy" data-ch-tab="north" class="ch-editor-tab ch-editor-tab-active" style="background:#3b4252;color:#d8dee9;border-right-color:#3b425200;border-bottom-color:#88c0d000"><div><span style="opacity:0.5"></span>deploy</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div class="ch-code-wrapper" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto;height:100%"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>dotnet publish ./Functions/Dotnet.CDK.Lambda/src/Dotnet.CDK.Lambda/ -c Release -r linux-x64</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>terraform init</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>terraform apply</span></div></div><br></code></div></div></div></div>
<p>Once deployed, invoke the Lambda function in AWS using the below command replacing the <span class="ch-inline-code not-prose"><code style="--ch-code-foreground:#d8dee9ff;background:#2e3440e6;color:#d8dee9ff"><span style="color:#D8DEE9">OUTPUT_FUNCTION_NAME</span></code></span> with the value output to your terminal:</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>dotnet lambda invoke-function -n OUTPUT_FUNCTION_NAME -p hello</span></div></div><br></code></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/developer-tooling/terraform.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/developer-tooling/cdk"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">AWS CDK</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/developer-tooling/pulumi"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Pulumi</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#terraform-provider" class="table-of-contents__link toc-highlight">Terraform Provider</a></li><li><a href="#s3-bucket-for-code-storage" class="table-of-contents__link toc-highlight">S3 Bucket for Code Storage</a></li><li><a href="#lambda-zip-package" class="table-of-contents__link toc-highlight">Lambda ZIP Package</a></li><li><a href="#cloudwatch" class="table-of-contents__link toc-highlight">CloudWatch</a></li><li><a href="#iam" class="table-of-contents__link toc-highlight">IAM</a></li><li><a href="#lambda-function-resource" class="table-of-contents__link toc-highlight">Lambda Function Resource</a></li><li><a href="#output-name" class="table-of-contents__link toc-highlight">Output Name</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Built by @plantpowerjames</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/plantpowerjames" target="_blank" rel="noopener noreferrer" class="footer__link-item">@plantpowerjames</a></li><li class="footer__item"><a href="https://github.com/jeastham1993/serverless-dotnet.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report Issues on GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Serverless .NET. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.983b73cc.js"></script>
<script src="/assets/js/main.761a135f.js"></script>
</body>
</html>